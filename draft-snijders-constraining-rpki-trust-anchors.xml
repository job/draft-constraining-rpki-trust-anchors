<?xml version='1.0' encoding='utf-8'?>

<!DOCTYPE rfc [
 <!ENTITY nbsp  "&#160;">
 <!ENTITY zwsp "&#8203;">
 <!ENTITY nbhy "&#8209;">
 <!ENTITY wj   "&#8288;">
]>

<?rfc sortrefs="yes"?>
<?rfc subcompact="no"?>
<?rfc symrefs="yes"?>
<?rfc toc="yes"?>
<?rfc tocdepth="3"?>
<?rfc compact="yes"?>
<?rfc subcompact="no"?>

<rfc xmlns:xi="http://www.w3.org/2001/XInclude"
     category="info"
     docName="draft-snijders-constraining-rpki-trust-anchors-00"
     ipr="trust200902"
     xml:lang="en"
     sortRefs="true"
     submissionType="independent"
     version="3">

  <front>

    <title abbrev="Constraining RPKI Trust Anchors">
      Constraining RPKI Trust Anchors
    </title>

    <seriesInfo name="Internet-Draft" value="draft-snijders-constraining-rpki-trust-anchors"/>

    <author fullname="Job Snijders" initials="J." surname="Snijders">
      <organization>OpenBSD</organization>
      <address>
        <postal>
          <country>NL</country>
        </postal>
        <email>job@openbsd.org</email>
      </address>
    </author>

    <author fullname="Theo Buehler" initials="T." surname="Buehler">
      <organization>OpenBSD</organization>
      <address>
        <postal>
          <country>CH</country>
        </postal>
        <email>tb@openbsd.org</email>
      </address>
    </author>

    <date />

    <area>ops</area>

    <keyword>RPKI</keyword>
    <keyword>security</keyword>
    <keyword>cryptography</keyword>
    <keyword>X.509</keyword>

    <abstract>
      <t>
        This document describes an approach for Resource Public Key Infrastructure (RPKI) Relying Parties (RPs) to impose locally configured Constraints on cryptographic products subordinate to publicly-trusted externally operated Trust Anchors (TAs), as implemented in OpenBSD's rpki-client validator.
        The capability to effectively constrain a Trust Anchor operator's signing authority to a limited set of Internet Number Resources (INRs), allows Relying Parties to enjoy the potential benefits of assuming trust within a bounded scope.
      </t>
    </abstract>
  </front>

  <middle>
    <section anchor="intro">
      <name>Introduction</name>
      <t>
         This document describes an approach for Resource Public Key Infrastructure (RPKI) Relying Parties (RPs) to impose locally configured Constraints on cryptographic products subordinate to publicly-trusted externally operated Trust Anchors (TAs), as implemented in the <xref target="OpenBSD"/> <xref target="rpki-client"/> validator.
         The capability to effectively constrain a Trust Anchor operator's abilities to a limited set of Internet Number Resources (INRs), allows Relying Parties to enjoy the potential benefits of assuming trust within a bounded scope.
      </t>

      <t>
        It is important to emphasize that each Relying Party makes its Trust Anchor inclusion decisions independently, on its own timelines, based on its own inclusion criteria; and that imposed Constraints (if any) are a matter of local configuration.
      </t>

      <t>
        This document is intended to address user (meaning, Network Operator and Relying Party) needs and concerns, and was authored to benefit users and providers of RPKI services by providing a common body of knowledge to be communicated within the global Internet routing system community.
      </t>

      <section anchor="definitions">
        <name>Definitions</name>
        <dl>
          <dt>Assumed Trust</dt>
          <dd>
            In the RPKI hierarchical structure, a Trust Anchor is an authority for which trust is assumed and not derived.
            Assuming trust means that violation of that trust is out-of-scope for the threat model.
          </dd>
          <dt>Derived Trust</dt>
          <dd>
            Derived Trust can be automatically and securely computed with subjective logic.
            In the context of the RPKI, trust is derived according to the rules for validation of RPKI Certificates and Signed Objects.
          </dd>
          <dt>Constraints</dt>
          <dd>
            The locally configured union set of IP prefixes, IP address ranges, AS identifiers, and AS identifier ranges for which the Relying Party operator anticipates the Trust Anchor operator to issue cryptographic products.
          </dd>
        </dl>
      </section>

      <section anchor="reading">
        <name>Required Reading</name>
        <t>
          Readers should be familiar with the RPKI, the RPKI repository structure, and the various RPKI objects, uses, and interpretations described in the following: <xref target="RFC3779"/>, <xref target="RFC6480"/>, <xref target="RFC6481"/>, <xref target="RFC6487"/>, and <xref target="RFC6488"/>.
        </t>
      </section>

    </section>

    <section anchor="overclaim">
      <name>Considerations on Trust Anchor over-claiming</name>
      <t>
        Currently, all five Regional Internet Registries (RIRs) list 'all-resources' (0.0.0.0/0, ::/0, and AS 0-4294967295) as subordinate on their Trust Anchor certificates in order to reduce some potential for risk of invalidation in the case of transient registry inconsistencies <xref target="I-D.rir-rpki-allres-ta-app-statement"/>.
        Such 'all-resources' listings demonstrate that - in the course of normal operations - Trust Anchors may claim authority for INRs outside the registry's current resource holdings.
      </t>
      <t>
        The primary reason for transient registry inconsistencies to occur would be when resources are transferred from one registry to another.
        However, the ability to transfer resources between registries is not universally available: this ability depends on the implementation of registry-specific consensus-driven policy development reciprocated by other registries.
        Another source of churn would be the inflow of new resources following allocations made by the IANA; but because of IPv4 address exhaustion, IPv6 abundance, and 32-bit ASNs being allocated in large blocks - IANA allocations occur far less often than they used to.
      </t>
      <t>
        Absent a registry's ability to execute inter-registry transfers or frequently receive new allocations from IANA, that registry's set of holdings would be a fairly static list of resources.
      </t>
      <t>
        Therefore, a Relying Party need not trust each and every signed product in a derived trust relationship to any and all INRs subordinate to the registry's Trust Anchor; even if the Trust Anchor certificate lists 'all-resources' as subordinate.
        Following the widely deployed information security principle of <xref target="priv">least privilege</xref>, constraining a given Trust Anchor's capacity strictly to just that what relates to the their respective current INR holdings, provides some degree of risk reduction for all stakeholders involved.
      </t>
      <t>
        Consequently, knowing a registry's current resource holdings and knowing this set of holdings will not change in the near-term future; following the principle of least privilege, operators can consider applying a restricted-service operating mode towards what otherwise would be an unbounded authority.
        The principle of constraining Trust Anchors might be useful when for example working with RPKI testbeds <xref target="OTE"/>, but also in dealings with publicly-trusted registries.
      </t>
    </section>

    <section anchor="constraining">
      <name>Constraining Trust Anchors by constraining End-Entity Certificates</name>
      <t>
        As noted in <xref target="overclaim"/>, RPKI CA certificates are expected to overclaim in the course of normal operations.
        However, applying a customized version of the certification path validation algorithm to CA certificates to prune all possible certificate paths related to INRs not contained within the locally configured Constraints would not be a trivial task.
        Instead, a simpler alternative approach operating on EE certificates is proposed.
      </t>
      <t>
        To constrain a Trust Anchor, the IP address and AS number resources listed in a given EE certificate's <xref target="RFC3779"/> extensions MUST be fully contained within the locally configured union set of IP prefixes, IP address ranges, AS identifiers, and AS identifier ranges for which the Relying Party operator anticipates the Trust Anchor operator to issue cryptographic products.
        If a given EE certificate's listed resources are not fully contained within the Constraints, the RP should halt processing and consider the EE certificate invalid.
      </t>
      <t>
        The above described approach applies to all RPKI objects for which an explicit listing of resources is mandated in their respective <xref target="RFC3779"/> extensions, such as BGPSec Router Certificates <xref target="RFC8209"/>, ROAs <xref target="I-D.ietf-sidrops-rfc6482bis"/>, ASPAs <xref target="I-D.ietf-sidrops-aspa-profile"/>, RSCs <xref target="RFC9323"/>, and Geofeeds <xref target="I-D.ietf-opsawg-9092-update"/>.
      </t>
      <t>
        The approach has no application in context of Signed Objects unrelated to INRs (which thus use 'inherit' elements) such as Ghostbusters records <xref target="RFC6493"/>, Signed TALs <xref target="I-D.ietf-sidrops-signed-tal"/>, and Manifests <xref target="RFC9286"/>.
      </t>
      <t>
        The validation of Constraint containment is a check in addition to all the validation checks specified in <xref target="RFC6487"/>, <xref target="RFC6488"/>, and each Signed Object's profile specification.
      </t>
    </section>

    <section anchor="ops">
      <name>Operational Considerations</name>
      <t>
        When assessing the feasibility of constraining a Trust Anchor's effective signing abilities to the registry's current set of holdings, it is important take note of possible future events which might impact the degree of churn in the registry's holdings.
      </t>
      <t>
        For example, AFRINIC has not yet ratified an inter-registry transfer policy <xref target="AFPUB-2020-GEN-006-DRAFT03"/>, and the policy proposal at hand indicates implementation is expected to take 12 months after ratification.
        IANA has not made allocations from the Current Recovered IPv4 Pool <xref target="recovered"/> in recent times, and Autonomous System Number allocations are also fairly infrequent <xref target="asns"/>.
        The aforementioned observations suggest there is a lot of operational runway to manage and distribute Constraints in a timely manner.
      </t>
      <t>
        Maintainers of Constraint lists disseminated as part of an operating system or a third-party software package release process would do well to assume a six month delay for users to update.
      </t>
    </section>

    <section anchor="security">
      <name>Security Considerations</name>
      <t>
        The routing security benefits promised by the RPKI are derived from assuming trust in registry operators to run flawless certification services.
        Assuming such trust exposes users to some potential for <xref target="risks"/> and adverse actions by Certificate Authorities <xref target="RFC8211"/>.
        Limiting a Trust Anchor's effective signing capabilities to its registry's current holdings (rather assuming unbounded authority) is an effective approach to limit some potential for risk.
      </t>
    </section>

  </middle>

  <back>
    <references>
      <name>References</name>
      <references>
        <name>Informative References</name>

        <reference anchor="OpenBSD" target="https://www.openbsd.org/">
          <front>
            <title>The OpenBSD Project</title>
            <author initials="T" surname="de Raadt" fullname="Theo de Raadt"/>
            <date year="2023" />
          </front>
        </reference>

        <reference anchor="rpki-client" target="https://www.rpki-client.org/">
          <front>
            <title>rpki-client</title>
            <author fullname="Claudio Jeker"/>
            <author fullname="Job Snijders"/>
            <author fullname="Kristaps Dzonsons"/>
            <author fullname="Theo Buehler"/>
            <date month="July" year="2023" />
          </front>
        </reference>

        <!-- anchor I-D.rir-rpki-allres-ta-app-statement -->
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml3/reference.I-D.rir-rpki-allres-ta-app-statement.xml"/>

        <!-- anchor I-D.ietf-sidrops-rfc6482bis -->
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-sidrops-rfc6482bis.xml"/>

        <!-- anchor I-D.ietf-sidrops-aspa-profile -->
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-sidrops-aspa-profile.xml"/>

        <!-- anchor I-D.ietf-opsawg-9092-update -->
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-opsawg-9092-update.xml"/>

        <xi:include href="https://bib.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-sidrops-signed-tal.xml"/>

        <reference anchor="AFPUB-2020-GEN-006-DRAFT03" target="https://afrinic.net/policy/proposals/2020-gen-006-d3">
          <front>
            <title>AFRINIC Number Resources Transfer Policy (Draft-3)</title>
            <author fullname="Gregoire Olaotan Ehoumi"/>
            <author fullname="Noah Maina"/>
            <author fullname="Adeola A. P. Aina"/>
            <date month="February" year="2022"/>
          </front>
        </reference>

        <reference anchor="priv" target="https://sha256.net/privsep.html">
          <front>
            <title>Privilege drop, privilege separation, and restricted-service operating mode in OpenBSD</title>
            <author fullname="Florian Obser"/>
          </front>
        </reference>

        <reference anchor="risks" target="https://www.cs.bu.edu/~goldbe/papers/hotRPKI.pdf">
          <front>
            <title>On the Risk of Misbehaving RPKI Authorities</title>
            <author fullname="Danny Cooper"/>
            <author fullname="Ethan Heilman"/>
            <author fullname="Kyle Brogle"/>
            <author fullname="Leonid Reyzin"/>
            <author fullname="Sharon Goldberg"/>
          </front>
        </reference>

        <reference anchor="OTE" target="https://www.arin.net/reference/tools/testing/">
          <front>
            <title>Operational Test and Evaluation (OT&amp;E) Environment</title>
            <author fullname="ARIN"/>
            <date year="2023"/>
          </front>
        </reference>

        <reference anchor="recovered" target="https://www.iana.org/assignments/ipv4-recovered-address-space/ipv4-recovered-address-space.xhtml">
          <front>
            <title>IPv4 Recovered Address Space</title>
            <author fullname="IANA"/>
            <date month="march" year="2019"/>
          </front>
        </reference>

        <reference anchor="asns" target="https://www.iana.org/assignments/as-numbers/as-numbers.xhtml">
          <front>
            <title>Autonomous System (AS) Numbers</title>
            <author fullname="IANA"/>
            <date month="August" year="2023"/>
          </front>
        </reference>

        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.3779.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6480.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6481.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6487.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6488.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6493.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8209.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8211.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.9286.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.9323.xml"/>
      </references>
    </references>

    <section anchor="constraints">
      <name>Example Constraints listing</name>
      <t>
        Below is an example list of Constraints related to AFRINIC-managed Internet Number Resources.
        By placing the below contents in a file named <strong>afrinic.constraints</strong> next to a Trust Anchor Locator file named <strong>afrinic.tal</strong>, the <xref target="rpki-client"/> implementation will consider all End-Entity certificates invalid which list resources not fully contained within the resources listed in the <strong>afrinic.constraints</strong> file.
      </t>

      <sourcecode type="text" src="afrinic.constraints"/>

    </section>

  </back>

</rfc>
